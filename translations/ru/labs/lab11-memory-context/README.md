# Lab 11: Память и Управление Контекстом

## Цель
Научиться реализовывать системы памяти: долговременное хранилище, извлечение, извлечение фактов и слои контекста.

## Теория

### Системы Памяти

Агентам нужна память для:
- Запоминания прошлых разговоров
- Хранения важных фактов
- Извлечения релевантной информации
- Эффективного управления контекстом

См. подробнее:
- [Глава 12: Системы Памяти Агента](../../book/12-agent-memory/README.md)
- [Глава 13: Управление Контекстом](../../book/13-context-engineering/README.md)

## Задание

В файле `main.go` реализуйте систему памяти с управлением контекстом.

### Часть 1: Хранилище Памяти

Реализуйте интерфейс `Memory`:
- `Store(key string, value any) error`
- `Retrieve(query string, limit int) ([]MemoryItem, error)`
- `Forget(key string) error`

### Часть 2: Извлечение Фактов

Реализуйте функцию `extractFacts(conversation string) ([]Fact, error)`:
- Используйте LLM для извлечения важных фактов
- Оцените факты по важности
- Сохраните факты отдельно

### Часть 3: Слои Контекста

Реализуйте `LayeredContext`:
- Рабочая память (недавние повороты)
- Слой саммари (саммаризированная история)
- Слой фактов (извлеченные факты)

### Часть 4: Саммаризация

Реализуйте функцию `summarizeConversation(messages []openai.ChatCompletionMessage) (string, error)`:
- Используйте LLM для создания саммари
- Сохраните ключевые факты
- Уменьшите количество токенов

## Критерии сдачи

✅ **Сдано:**
- Хранилище памяти реализовано
- Извлечение фактов работает
- Слои контекста реализованы
- Саммаризация уменьшает токены
- Агент помнит важные факты

❌ **Не сдано:**
- Нет персистентности памяти
- Факты не извлекаются
- Контекст не слоится
- Саммаризация теряет важную информацию

---

**Следующий шаг:** После завершения Lab 11 переходите к [Lab 12: Протокол Сервера Инструментов](../lab12-tool-server/README.md).
