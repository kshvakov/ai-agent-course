# Lab 12: Протокол Сервера Инструментов

## Цель
Научиться реализовывать серверы инструментов: протоколы stdio/HTTP, версионирование схем и архитектура сервера инструментов. В production также часто используют gRPC из-за строгого контракта и встроенных механизмов безопасности и наблюдаемости.

## Теория

### Серверы Инструментов

По мере роста агентов инструменты становятся сервисами:
- **Отдельные процессы** — Инструменты работают независимо
- **Протокольная коммуникация** — stdio, HTTP или gRPC (в production)
- **Версионирование схем** — Обработка обновлений инструментов
- **Изоляция** — Инструменты изолированы для безопасности

См. подробнее: [Глава 18: Протоколы Инструментов и Tool Servers](../../book/18-tool-protocols-and-servers/README.md)

## Задание

В файле `main.go` реализуйте сервер инструментов с поддержкой протоколов.

### Часть 1: Протокол stdio

Реализуйте `StdioToolServer`:
- Читайте запросы из stdin
- Выполняйте инструменты
- Записывайте ответы в stdout

### Часть 2: Протокол HTTP

Реализуйте `HTTPToolServer`:
- HTTP endpoint для выполнения инструментов
- Формат запроса/ответа JSON
- Обработка ошибок

### Часть 3: Версионирование Схем

Реализуйте `ToolDefinition` с версионированием:
- Поле версии
- Список совместимых версий
- Проверка версий

### Часть 4: Интеграция с Агентом

Реализуйте клиент инструментов на стороне агента:
- Вызывайте сервер инструментов через протокол
- Обрабатывайте совместимость версий
- Обработка ошибок

## Критерии сдачи

✅ **Сдано:**
- Протокол stdio реализован
- Протокол HTTP реализован
- Версионирование схем работает
- Агент может вызывать сервер инструментов
- Совместимость версий проверяется

❌ **Не сдано:**
- Нет версионирования, обновления ломают совместимость
- Протокол не реализован
- Агент не может вызывать сервер инструментов

---

**Следующий шаг:** После завершения Lab 12 вы освоили продвинутые паттерны агентов! Рассмотрите опциональные продвинутые темы из руководства: [Глава 17: Security и Governance](../../book/17-security-and-governance/README.md) или [Глава 23: Evals в CI/CD](../../book/23-evals-in-cicd/README.md).
